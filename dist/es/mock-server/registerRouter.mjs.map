{"version":3,"file":"registerRouter.mjs","sources":["../../../packages/mock-server/registerRouter.ts"],"sourcesContent":["import type { Router, Request } from 'express';\nimport { ParamsDictionary } from 'express-serve-static-core';\nimport { ParsedQs } from 'qs';\n\nexport type CallbackRequest = Request<ParamsDictionary, any, any, ParsedQs, Record<string, any>>;\nexport type RegisterRouterParam = {\n    method?: 'get' | 'delete' | 'put' | 'post';\n    path: string;\n    reqHandler: (req: CallbackRequest) => any;\n    time?: number\n};\nexport type RegisterRouterFunction = (param: RegisterRouterParam) => void;\n\nfunction registerRouterFactory(router: Router) {\n    /**\n     * 呼叫 API 方法\n     * @param  {String} method 請求方式\n     * @param  {String} path API 路徑\n     * @param  {Object} json 回傳的 json 物件\n     * @param  {Number} time 模擬回傳的時間\n     */\n    const registerRouter: RegisterRouterFunction = ({\n        method = 'get',\n        path,\n        reqHandler,\n        time = 800\n    }) => {\n        router[method](path, (req, res) => {\n            console.log(req.url);\n            setTimeout(() => {\n                res.json(reqHandler.bind({}, req)());\n            }, time);\n        });\n    };\n\n    return registerRouter;\n}\n\nexport default registerRouterFactory;\n"],"names":[],"mappings":"AAaA,+BAA+B,QAAgB;AAQ3C,QAAM,iBAAyC,CAAC;AAAA,IAC5C,SAAS;AAAA,IACT;AAAA,IACA;AAAA,IACA,OAAO;AAAA,QACL;AACF,WAAO,QAAQ,MAAM,CAAC,KAAK,QAAQ;AAC/B,cAAQ,IAAI,IAAI;AAChB,iBAAW,MAAM;AACb,YAAI,KAAK,WAAW,KAAK,IAAI;AAAA,SAC9B;AAAA;AAAA;AAIX,SAAO;AAAA;;;;"}