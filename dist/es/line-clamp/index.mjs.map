{"version":3,"file":"index.mjs","sources":["../../../packages/line-clamp/index.ts"],"sourcesContent":["interface Binding {\n    /** 行高(px) */\n    lineHeight?: string;\n    /** 最多幾行 */\n    lineCount: string;\n}\n\n/**\n * @param clampValueProp\n * 紀錄最多幾行的屬性名稱\n * `default: v-line-clamp-value`\n *\n * @param dotPaddingProp\n * 紀錄縮寫點位移的屬性名稱(不支援webkitLineClamp的瀏覽器才會加上)\n * `default: v-dot-padding`\n */\nconst lineClampFactory = (\n    clampValueProp = 'v-line-clamp-value',\n    dotPaddingProp = 'v-dot-padding'\n) => {\n    /**\n     * 綁定初始css到element上\n     */\n    const addInitStyle = (el: HTMLElement) => {\n        el.style.cssText += `\n            display: block;\n            display: -webkit-box;\n            -webkit-box-orient: vertical;\n            overflow: hidden;\n            word-break: break-all;\n            text-overflow: ellipsis;\n        `;\n    };\n\n    const checkDotShow = (el: HTMLElement) => {\n        const elContentHeight = el.scrollHeight;\n        const elWrapHeight = el.getBoundingClientRect().height;\n        const dotPadding = parseFloat(el.getAttribute(dotPaddingProp) || 'none') || 0;\n\n        if (elContentHeight > elWrapHeight) {\n            el.insertAdjacentHTML('afterbegin', `\n                <span style=\"\n                    float: right;\n                    height: ${dotPadding}px;\n                    display: block;\n                \"></span>\n                <span style=\"\n                    float: right;\n                    clear: both;\n                \">...</span>\n            `);\n        }\n    };\n\n    function defaultFallbackFunc(el: HTMLElement, bindings: Binding, lines: number) {\n        const computedLineHeight = getComputedStyle(el).lineHeight.replace('px', '');\n        let lineHeight = parseFloat(computedLineHeight);\n\n        if (bindings.lineHeight) {\n            const argLineHeight = parseInt(bindings.lineHeight || 'none');\n\n            if (isNaN(argLineHeight)) {\n                // eslint-disable-next-line no-console\n                console.warn('line-height argument for vue-line-clamp must be a number (of pixels)');\n            } else {\n                lineHeight = argLineHeight;\n                el.style.lineHeight = lineHeight + 'px';\n            }\n        }\n\n        const maxHeight = lineHeight * lines;\n\n        el.style.maxHeight = maxHeight ? maxHeight + 'px' : '';\n        el.setAttribute(dotPaddingProp,`${maxHeight - lineHeight}`);\n\n        requestAnimationFrame(() => {\n            checkDotShow(el);\n        });\n    }\n\n    const useFallbackFunc = 'webkitLineClamp' in document.body.style ? undefined : defaultFallbackFunc;\n\n    /**\n     * 根據內容長度截斷文字\n     */\n    const truncateText = (el: HTMLElement, bindings: Binding) => {\n        const lines = parseInt(bindings.lineCount);\n        const bindValue = parseInt(el.getAttribute(clampValueProp) || 'none');\n\n        if (isNaN(lines)) {\n            // eslint-disable-next-line no-console\n            console.error('Parameter for vue-line-clamp must be a number');\n            return;\n        }\n\n        if (lines !== bindValue) {\n            el.setAttribute(clampValueProp, `${lines}`);\n\n            if (useFallbackFunc) {\n                useFallbackFunc(el, bindings, lines);\n            } else {\n                (el as HTMLElement).style.webkitLineClamp = lines ? `${lines}` : '';\n            }\n            return;\n        }\n\n        if (useFallbackFunc) {\n            checkDotShow(el);\n        }\n    };\n\n    return {\n        addInitStyle,\n        truncateText\n    };\n};\n\nexport default lineClampFactory;"],"names":[],"mappings":"MAgBM,mBAAmB,CACrB,iBAAiB,sBACjB,iBAAiB,oBAChB;AAID,QAAM,eAAe,CAAC,OAAoB;AACtC,OAAG,MAAM,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUxB,QAAM,eAAe,CAAC,OAAoB;AACtC,UAAM,kBAAkB,GAAG;AAC3B,UAAM,eAAe,GAAG,wBAAwB;AAChD,UAAM,aAAa,WAAW,GAAG,aAAa,mBAAmB,WAAW;AAE5E,QAAI,kBAAkB,cAAc;AAChC,SAAG,mBAAmB,cAAc;AAAA;AAAA;AAAA,8BAGlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAW1B,+BAA6B,IAAiB,UAAmB,OAAe;AAC5E,UAAM,qBAAqB,iBAAiB,IAAI,WAAW,QAAQ,MAAM;AACzE,QAAI,aAAa,WAAW;AAE5B,QAAI,SAAS,YAAY;AACrB,YAAM,gBAAgB,SAAS,SAAS,cAAc;AAEtD,UAAI,MAAM,gBAAgB;AAEtB,gBAAQ,KAAK;AAAA,aACV;AACH,qBAAa;AACb,WAAG,MAAM,aAAa,aAAa;AAAA;AAAA;AAI3C,UAAM,YAAY,aAAa;AAE/B,OAAG,MAAM,YAAY,YAAY,YAAY,OAAO;AACpD,OAAG,aAAa,gBAAe,GAAG,YAAY;AAE9C,0BAAsB,MAAM;AACxB,mBAAa;AAAA;AAAA;AAIrB,QAAM,kBAAkB,qBAAqB,SAAS,KAAK,QAAQ,SAAY;AAK/E,QAAM,eAAe,CAAC,IAAiB,aAAsB;AACzD,UAAM,QAAQ,SAAS,SAAS;AAChC,UAAM,YAAY,SAAS,GAAG,aAAa,mBAAmB;AAE9D,QAAI,MAAM,QAAQ;AAEd,cAAQ,MAAM;AACd;AAAA;AAGJ,QAAI,UAAU,WAAW;AACrB,SAAG,aAAa,gBAAgB,GAAG;AAEnC,UAAI,iBAAiB;AACjB,wBAAgB,IAAI,UAAU;AAAA,aAC3B;AACH,QAAC,GAAmB,MAAM,kBAAkB,QAAQ,GAAG,UAAU;AAAA;AAErE;AAAA;AAGJ,QAAI,iBAAiB;AACjB,mBAAa;AAAA;AAAA;AAIrB,SAAO;AAAA,IACH;AAAA,IACA;AAAA;AAAA;;;;"}